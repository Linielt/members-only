<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Homepage</title>
</head>
<body>
    <% if (locals.user) {%>
        <h1>WELCOME BACK <%= locals.user.username %></h1>
        <form action="/auth/logout" method="GET">
            <button type="submit">Logout</button>
        </form>
        <form action="/post/create-post" method="GET">
            <button type="submit">Create Post</button>
        </form>
        <% if (locals.posts && locals.posts.length > 0) { %>
            <% locals.posts.forEach(function(post) { %>
                <div class="post">
                    <h2><%= post.title %></h2>
                    <p><%= post.body %></p>
                    <p>Author ID: <%= post.author_id %></p>
                    <p>Created At: <%= post.created_at.toLocaleString() %></p>
                    <% if (locals.user.is_admin) { %>
                        <form name="deletePost" action="/post/delete/<%= post.id %>" method="POST">
                            <button type="submit">Delete</button>
                        </form>
                    <% } %>
                </div>
            <% }) %>
        <% } else { %>
            <p>Zero posts available</p>
        <% } %>    
      <% } else { %>
        <h2>Welcome to the Secret Forum</h2>
        <p>This is a members-only forum where you can login and view and make anonymous posts</p>
        <form action="/auth/login" method="GET">
            <button type="submit">Login</button>
        </form>
      <%}%>
</body>
</html>